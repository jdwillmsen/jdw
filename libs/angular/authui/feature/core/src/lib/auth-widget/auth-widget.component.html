<button
  [matMenuTriggerFor]="menu"
  color="primary"
  mat-mini-fab
  matTooltip="Account"
  data-cy="auth-widget-button"
>
  @if (isLoggedIn) {
    @if (doesIconExist) {
      <mat-icon class="sign-in-icon" data-cy="sign-in-icon" />
      <img
        [src]="'data:image/png;base64,' + user?.profile?.icon?.icon"
        alt="Account Icon"
        data-cy="icon-image"
        class="avatar"
      />
    } @else {
      <mat-icon data-cy="no-icon-icon">person</mat-icon>
    }
  } @else {
    <mat-icon data-cy="sign-out-icon">login</mat-icon>
  }
</button>

<mat-menu #menu="matMenu" xPosition="before">
  @if (isLoggedIn) {
    <button mat-menu-item (click)="goToAccount()" data-cy="account-button">
      <mat-icon>account_circle</mat-icon>
      <span>Account</span>
    </button>
    <button mat-menu-item (click)="signIn()" data-cy="switch-account-button">
      <mat-icon>switch_account</mat-icon>
      <span>Switch Account</span>
    </button>
    <button mat-menu-item (click)="signOut()" data-cy="sign-out-button">
      <mat-icon>logout</mat-icon>
      <span>Sign Out</span>
    </button>
  } @else {
    <button mat-menu-item (click)="signIn()" data-cy="sign-in-button">
      <mat-icon>login</mat-icon>
      <span>Sign In</span>
    </button>
    <button mat-menu-item (click)="signUp()" data-cy="sign-up-button">
      <mat-icon>person_add</mat-icon>
      <span>Sign Up</span>
    </button>
  }
</mat-menu>
